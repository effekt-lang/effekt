module splice

import effekt
import stringbuffer

effect literal(s: String): Unit
effect splice[A](x: A): Unit

def s { prog: () => Unit / { literal, splice[String] } }: String = {
  with stringBuffer
  try {
    prog()
    do flush()
  } with splice[String] { x =>
    resume(do write(x))
  } with literal { s =>
    resume(do write(s))
  }
}
